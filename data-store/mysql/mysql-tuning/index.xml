<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>性能调优 on IWiki</title>
    <link>https://localhost:1313/data-store/mysql/mysql-tuning/</link>
    <description>Recent content in 性能调优 on IWiki</description>
    <generator>Hugo</generator>
    <language>iwiki</language>
    <atom:link href="https://localhost:1313/data-store/mysql/mysql-tuning/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>表结构优化</title>
      <link>https://localhost:1313/data-store/mysql/mysql-tuning/table-tuning/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://localhost:1313/data-store/mysql/mysql-tuning/table-tuning/</guid>
      <description>&lt;h1 id=&#34;表结构优化&#34;&gt;&#xD;&#xA;  表结构优化&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e8%a1%a8%e7%bb%93%e6%9e%84%e4%bc%98%e5%8c%96&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&#xD;&#xA;&lt;h4 id=&#34;合理设计表结构&#34;&gt;&#xD;&#xA;  合理设计表结构&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e5%90%88%e7%90%86%e8%ae%be%e8%ae%a1%e8%a1%a8%e7%bb%93%e6%9e%84&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;尽量将表字段定义为 NOT NULL 约束&lt;/li&gt;&#xA;&lt;li&gt;单表不要有太多字段，建议在20以内&lt;/li&gt;&#xA;&lt;li&gt;VARCHAR 类型只分配真正需要的空间&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;选取最适用的字段属性优先最简单的数据类型&#34;&gt;&#xD;&#xA;  选取最适用的字段属性，优先最简单的数据类型&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e9%80%89%e5%8f%96%e6%9c%80%e9%80%82%e7%94%a8%e7%9a%84%e5%ad%97%e6%ae%b5%e5%b1%9e%e6%80%a7%e4%bc%98%e5%85%88%e6%9c%80%e7%ae%80%e5%8d%95%e7%9a%84%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;尽量使用数字型字段&lt;/li&gt;&#xA;&lt;li&gt;尽量使用 VARCHAR 代替 CHAR&lt;/li&gt;&#xA;&lt;li&gt;尽量使用 TIMESTAMP 代替 DATETIME&lt;/li&gt;&#xA;&lt;li&gt;尽量使用 TINYINT、SMALLINT、MEDIUMINT 代替 INT&lt;/li&gt;&#xA;&lt;li&gt;对于特定类型字段，可用enum、set 等符合的数据类型&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;将字段多的表分解成多个表增加中间表&#34;&gt;&#xD;&#xA;  将字段多的表分解成多个表，增加中间表。&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e5%b0%86%e5%ad%97%e6%ae%b5%e5%a4%9a%e7%9a%84%e8%a1%a8%e5%88%86%e8%a7%a3%e6%88%90%e5%a4%9a%e4%b8%aa%e8%a1%a8%e5%a2%9e%e5%8a%a0%e4%b8%ad%e9%97%b4%e8%a1%a8&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;h4 id=&#34;混用范式与反范式适当冗余&#34;&gt;&#xD;&#xA;  混用范式与反范式，适当冗余&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e6%b7%b7%e7%94%a8%e8%8c%83%e5%bc%8f%e4%b8%8e%e5%8f%8d%e8%8c%83%e5%bc%8f%e9%80%82%e5%bd%93%e5%86%97%e4%bd%99&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;第一范式：数据表中每个字段都必须是不可拆分的最小单元&lt;/li&gt;&#xA;&lt;li&gt;第二范式：满足一范式后，要求每条记录由主键唯一区分，记录中所有属性都依赖于主键。&lt;/li&gt;&#xA;&lt;li&gt;第三范式：满足二范式后，要求所有属性必须直接依赖主键，不允许间接依赖。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;分库分表读写分离&#34;&gt;&#xD;&#xA;  分库分表，读写分离&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e5%88%86%e5%ba%93%e5%88%86%e8%a1%a8%e8%af%bb%e5%86%99%e5%88%86%e7%a6%bb&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;垂直分表（按列）&lt;/li&gt;&#xA;&lt;li&gt;水平分表（按行）：按时间分表、按区间分表、按hash分表&lt;/li&gt;&#xA;&lt;/ul&gt;</description>
    </item>
    <item>
      <title>索引优化</title>
      <link>https://localhost:1313/data-store/mysql/mysql-tuning/index-tuning/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://localhost:1313/data-store/mysql/mysql-tuning/index-tuning/</guid>
      <description>&lt;h1 id=&#34;索引优化&#34;&gt;&#xD;&#xA;  索引优化&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e7%b4%a2%e5%bc%95%e4%bc%98%e5%8c%96&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&#xD;&#xA;&lt;h4 id=&#34;建立合适的索引&#34;&gt;&#xD;&#xA;  建立合适的索引&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e5%bb%ba%e7%ab%8b%e5%90%88%e9%80%82%e7%9a%84%e7%b4%a2%e5%bc%95&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;索引应建立在区分度高、数据量小的字段上&lt;/li&gt;&#xA;&lt;li&gt;对数字的索引效率要优于字符串&lt;/li&gt;&#xA;&lt;li&gt;下列情况，应建立索引&#xA;&lt;ul&gt;&#xA;&lt;li&gt;外键&lt;/li&gt;&#xA;&lt;li&gt;经常作为查询条件的字段&lt;/li&gt;&#xA;&lt;li&gt;经常与其他表进行连接的字段&lt;/li&gt;&#xA;&lt;li&gt;经常需要排序、分组和联合操作的字段&lt;/li&gt;&#xA;&lt;li&gt;执行频率高（几千次/每天）的语句&lt;/li&gt;&#xA;&lt;li&gt;数据量大（超过300万）的表&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;控制索引的数量&#34;&gt;&#xD;&#xA;  控制索引的数量&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e6%8e%a7%e5%88%b6%e7%b4%a2%e5%bc%95%e7%9a%84%e6%95%b0%e9%87%8f&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;删除不再使用或者很少使用的索引&lt;/li&gt;&#xA;&lt;li&gt;频繁进行数据更新操作的表，不要建立太多的索引&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;充分利用索引查询避免全表扫描&#34;&gt;&#xD;&#xA;  充分利用索引查询，避免全表扫描&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e5%85%85%e5%88%86%e5%88%a9%e7%94%a8%e7%b4%a2%e5%bc%95%e6%9f%a5%e8%af%a2%e9%81%bf%e5%85%8d%e5%85%a8%e8%a1%a8%e6%89%ab%e6%8f%8f&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;全表扫描：读取表所有数据，检查每一行是否满足给定条件的过程。&lt;/li&gt;&#xA;&lt;li&gt;导致索引失效的情况&#xA;&lt;ul&gt;&#xA;&lt;li&gt;使用 null 、not、&amp;lt;&amp;gt;、!=、参数、内置函数&lt;/li&gt;&#xA;&lt;li&gt;or 拼接非索引字段&lt;/li&gt;&#xA;&lt;li&gt;like 前模糊匹配，形如‘%abc’&lt;/li&gt;&#xA;&lt;li&gt;对索引字段进行操作运算&lt;/li&gt;&#xA;&lt;li&gt;不符合复合索引的最左前缀匹配原则&lt;/li&gt;&#xA;&lt;li&gt;查询的数量是大表的大部分（30％以上）&lt;/li&gt;&#xA;&lt;li&gt;列与列进行比较&lt;/li&gt;&#xA;&lt;li&gt;数据类型转换，包括显式与隐式&lt;/li&gt;&#xA;&lt;li&gt;尽量使用前缀来索引&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;</description>
    </item>
    <item>
      <title>引擎优化</title>
      <link>https://localhost:1313/data-store/mysql/mysql-tuning/engine-tuning/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://localhost:1313/data-store/mysql/mysql-tuning/engine-tuning/</guid>
      <description>&lt;h1 id=&#34;引擎优化&#34;&gt;&#xD;&#xA;  引擎优化&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e5%bc%95%e6%93%8e%e4%bc%98%e5%8c%96&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&#xD;&#xA;&lt;h3 id=&#34;innodb&#34;&gt;&#xD;&#xA;  InnoDB&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#innodb&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;禁用唯一性检查&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;-- 唯一性校验会降低插入记录的速度，&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;-- 可以在插入记录之前禁用唯一性检查，插入数据完成后再开启&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#bbb&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#bbb&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;-- 禁用唯一性检查&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;SET&lt;/span&gt;&lt;span style=&#34;color:#bbb&#34;&gt; &lt;/span&gt;UNIQUE_CHECKS&lt;span style=&#34;color:#bbb&#34;&gt; &lt;/span&gt;=&lt;span style=&#34;color:#bbb&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#b452cd&#34;&gt;0&lt;/span&gt;;&lt;span style=&#34;color:#bbb&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#bbb&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;-- 开启唯一性检查&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#228b22&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#00688b;font-weight:bold&#34;&gt;SET&lt;/span&gt;&lt;span style=&#34;color:#bbb&#34;&gt; &lt;/span&gt;UNIQUE_CHECKS&lt;span style=&#34;color:#bbb&#34;&gt; &lt;/span&gt;=&lt;span style=&#34;color:#bbb&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#b452cd&#34;&gt;1&lt;/span&gt;;&lt;span style=&#34;color:#bbb&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pr</description>
    </item>
    <item>
      <title>SQL优化</title>
      <link>https://localhost:1313/data-store/mysql/mysql-tuning/sql-tuning/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://localhost:1313/data-store/mysql/mysql-tuning/sql-tuning/</guid>
      <description>&lt;h1 id=&#34;sql优化&#34;&gt;&#xD;&#xA;  SQL优化&#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#sql%e4%bc%98%e5%8c%96&#34;&gt;#&lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;避免使用双引号，用单引号代替&lt;/li&gt;&#xA;&lt;li&gt;避免使用 *，用具体列名代替&lt;/li&gt;&#xA;&lt;li&gt;避免使用 in，用 exist 代替&lt;/li&gt;&#xA;&lt;li&gt;尽量使用UNION ALL代替UNION&lt;/li&gt;&#xA;&lt;li&gt;尽量使用预编译：性能更好、防止SQL注入&lt;/li&gt;&#xA;&lt;li&gt;尽量少做重复的工作&lt;/li&gt;&#xA;&lt;li&gt;尽量避免耗时操作：DISTINCT、UNION、MINUS、INTERSECT、ORDER   BY&lt;/li&gt;&#xA;&lt;li&gt;尽量避免使用游标&lt;/li&gt;&#xA;&lt;li&gt;尽量避免使用临时表&lt;/li&gt;&#xA;&lt;li&gt;尽量避免大事务操作&lt;/li&gt;&#xA;&lt;li&gt;尽量避免向客户端返回大数据量&lt;/li&gt;&#xA;&lt;li&gt;分析 sql 语句：分析慢查询日志   利用分析工具：Explain、Profile&lt;/li&gt;&#xA;&lt;/ul&gt;</description>
    </item>
  </channel>
</rss>
